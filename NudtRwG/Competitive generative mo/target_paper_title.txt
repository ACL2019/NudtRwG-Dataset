Competitive generative models with structure learning for NLP classification tasks