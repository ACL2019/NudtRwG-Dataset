Discriminative Learning for Joint Template Filling